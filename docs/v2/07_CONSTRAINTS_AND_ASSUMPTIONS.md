# Vibe Pay 개발 사양서: 7. 제약사항 및 가정

이 문서는 Vibe Pay 시스템의 개발 및 운영에 영향을 미치는 제약사항과 프로젝트 진행 시 명시적으로 가정한 내용들을 정의한다.

## 1. 기술적 제약사항

-   **PG사 연동 방식**: 현재 시스템은 PG사 결제창을 팝업 형태로 호출하고, 클라이언트-PG사-클라이언트-서버의 흐름을 따르는 방식에 최적화되어 있다. 이는 PG사 SDK 및 연동 가이드라인에 따른 제약이다.
-   **데이터베이스**: PostgreSQL을 사용하며, 관계형 데이터베이스의 특성(ACID 트랜잭션, 스키마 기반)을 따른다. NoSQL 데이터베이스로의 전환은 추가적인 설계 및 구현 노력이 필요하다.
-   **Java 버전**: 백엔드는 Java 17을 기반으로 개발되었다. 하위 Java 버전과의 호환성은 보장되지 않는다.
-   **프론트엔드 프레임워크**: Nuxt.js (Vue.js) 기반으로 개발되었으며, 다른 프론트엔드 프레임워크(React, Angular 등)로의 전환은 상당한 재작업을 요구한다.
-   **동시성 처리**: 현재 동시성 처리는 주로 RDBMS의 트랜잭션과 시퀀스 기반 ID 채번, 그리고 애플리케이션 레벨의 비관적/낙관적 락(명시적 구현은 없음)에 의존한다. 초당 수천 건 이상의 고성능 동시성 처리가 필요한 경우, 메시지 큐, 분산 락 등의 추가적인 아키텍처 고려가 필요하다.

## 2. 비즈니스 제약사항

-   **PG사 정책**: 각 PG사의 결제 및 환불 정책(예: 부분 취소 가능 여부, 취소 기한, 수수료 정책)은 시스템 구현에 직접적인 영향을 미친다. PG사 정책 변경 시 시스템 수정이 필요할 수 있다.
-   **포인트 정책**: 포인트의 적립, 사용, 소멸, 환불 시 복원 등은 현재 정의된 비즈니스 로직에 따라 동작한다. 정책 변경 시 관련 로직 수정이 필요하다.
-   **주문/클레임 유형**: 현재 주문(ORDERED) 및 취소(CANCELLED)만 지원한다. 반품, 교환 등 추가적인 클레임 유형이 필요한 경우 `ord_proc_seq` 확장을 고려해야 한다.

## 3. 명시적 가정 (Assumptions)

-   **인증/인가 시스템**: 사용자 인증 및 기본적인 API 접근 제어는 Vibe Pay 시스템 외부에 존재하는 별도의 인증/인가 시스템(예: SSO, OAuth2 서버, API Gateway)에 의해 처리된다고 가정한다. Vibe Pay 백엔드 자체에는 사용자 인증 및 권한 관리 로직이 포함되어 있지 않다.
-   **네트워크 안정성**: PG사와의 통신 및 데이터베이스와의 통신은 일반적으로 안정적이라고 가정한다. 일시적인 네트워크 불안정성에 대한 재시도 로직은 일부 고려되었으나, 광범위한 분산 시스템 환경에서의 장애 복구 시나리오는 추가적인 설계가 필요하다.
-   **데이터 정합성**: `payment_interface_request_log` 테이블에 PG사와의 모든 통신 내역이 기록되므로, 결제 실패 시 해당 로그를 통해 원인 분석 및 수동 복구(필요 시)가 가능하다고 가정한다.
-   **클라이언트 신뢰**: 클라이언트에서 `orderId`를 미리 채번하여 전달하는 등 일부 정보는 클라이언트가 신뢰할 수 있는 환경에서 동작한다고 가정한다. 다만, 최종 결제 승인은 반드시 서버 간 통신(S2S)을 통해 검증되므로 핵심적인 결제 금액 위변조는 방지된다.
-   **상품 정보**: `product` 테이블에 등록된 상품 정보는 항상 유효하며, 주문 시점에 해당 상품이 존재한다고 가정한다. 재고 관리 로직은 현재 시스템에 포함되어 있지 않다.
-   **환경변수 관리**: 운영 환경에서 필요한 모든 민감한 환경변수(PG사 키, DB 접속 정보 등)는 배포 시점에 적절하게 주입된다고 가정한다.
